:root {
    --bg: #050505;
    --bg-panel: #101010;
    --bg-panel-alt: #171717;
    --accent: #bf0904;
    /* Money Heist red */
    --accent-soft: #d42a41;
    --text: #f6f6f6;
    --muted: #8d8d8d;
    --code: #11c76f;
    --warning: #f7b733;
    --error: #ff4b5c;
    --success: #00c853;
    --border: #262626;
    --shadow: 0 0 25px rgba(0, 0, 0, 0.7);
    --radius: 12px;
    --transition: 0.25s ease;
    --font-main: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

*,
*::before,
*::after {
    box-sizing: border-box;
}

body {
    margin: 0;
    min-height: 100vh;
    background: radial-gradient(circle at top, #191919 0, #050505 55%, #000 100%);
    color: var(--text);
    font-family: var(--font-main);
    overflow-x: hidden;
}

/* Noise overlay for cinematic effect */
.noise-overlay {
    position: fixed;
    inset: 0;
    pointer-events: none;
    opacity: 0.12;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160' viewBox='0 0 160 160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.7'/%3E%3C/svg%3E");
    mix-blend-mode: soft-light;
    z-index: 0;
}

/* Top bar */
.top-bar {
    position: sticky;
    top: 0;
    z-index: 10;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 26px;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.92), rgba(0, 0, 0, 0.75));
    border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    backdrop-filter: blur(12px);
}

.logo-area {
    display: flex;
    align-items: center;
    gap: 10px;
}

/* 3D rotating logo image */
.logo-3d-wrapper {
    display: inline-block;
    margin-left: 8px;
    perspective: 600px;
    /* gives depth for rotateY */
    /*[web:138][web:141]*/
}

.logo-3d-img {
    /* choose the size you want relative to its own image ratio */
    height: 32px;
    /* controls overall size */
    width: auto;
    /* keeps original aspect ratio */
    object-fit: contain;
    display: block;
    transform-style: preserve-3d;
    animation: spinY 4s linear infinite;
}

/* pause on hover so users can inspect it */
.logo-3d-wrapper:hover .logo-3d-img {
    animation-play-state: paused;
}

/* 3D rotateY animation */
@keyframes spinY {
    0% {
        transform: rotateY(0deg);
    }

    100% {
        transform: rotateY(360deg);
    }
}

.mask-icon {
    font-size: 1.5rem;
}

.site-title {
    text-transform: uppercase;
    letter-spacing: 0.12em;
    font-size: 0.9rem;
    color: var(--muted);
}

.status-lights {
    display: flex;
    gap: 8px;
}

.light {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #333;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.7);
}

.light.red {
    background: #ff4b5c;
    box-shadow: 0 0 12px rgba(255, 75, 92, 0.7);
}

.light.amber {
    background: #f7b733;
    box-shadow: 0 0 12px rgba(247, 183, 51, 0.5);
}

.light.green {
    background: #00c853;
    box-shadow: 0 0 12px rgba(0, 200, 83, 0.5);
}

/* Layout */
.container {
    position: relative;
    z-index: 1;
    max-width: 1100px;
    margin: 0 auto;
    padding: 24px 16px 40px;
}

/* Hero */
.hero {
    display: grid;
    grid-template-columns: 3fr 2fr;
    gap: 28px;
    align-items: center;
    margin: 18px 0 24px;
}

.hero-text h1 {
    font-size: clamp(2.1rem, 4vw, 2.7rem);
    margin: 0 0 10px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
}

.hero-text p {
    margin: 0 0 18px;
    color: var(--muted);
    max-width: 480px;
    line-height: 1.5;
}

.hero-art {
    position: relative;
    justify-self: center;
}

/* Mask illustration */
.salvador-mask {
    position: relative;
    width: 220px;
    height: 260px;
    filter: drop-shadow(0 14px 30px rgba(0, 0, 0, 0.8));
}

.hood {
    position: absolute;
    inset: -12px -18px -14px;
    background: radial-gradient(circle at top, var(--accent-soft), var(--accent) 35%, #4a0202 80%);
    border-radius: 55% 45% 52% 48% / 35% 35% 65% 65%;
    z-index: 1;
}

.mask-face {
    position: relative;
    margin: 22px auto 0;
    width: 70%;
    height: 75%;
    background: #f2dcc3;
    border-radius: 55% 45% 52% 48% / 45% 45% 55% 55%;
    box-shadow: inset 0 0 0 2px rgba(0, 0, 0, 0.35);
    z-index: 2;
}

.mask-eyes {
    position: absolute;
    top: 32%;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    justify-content: space-between;
    width: 70%;
}

.eye {
    width: 32px;
    height: 18px;
    border-radius: 50%;
    border: 3px solid #121212;
    border-top-width: 4px;
    background: #000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.55);
}

.eye::after {
    content: "";
    position: absolute;
    inset: 6px 10px auto auto;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #fff, #aaa);
}

.mask-brow {
    position: absolute;
    top: 23%;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    height: 24px;
    border-radius: 50%;
    border-top: 5px solid #111;
}

.mask-mustache {
    position: absolute;
    bottom: 20%;
    left: 50%;
    transform: translateX(-50%);
    width: 70%;
    height: 28px;
    border-radius: 0 0 60% 60%;
    border-bottom: 5px solid #111;
    border-left: 5px solid transparent;
    border-right: 5px solid transparent;
}

/* Code rain behind mask */
.code-rain {
    position: absolute;
    inset: -22px -40px -30px auto;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.4), transparent);
    overflow: hidden;
    border-radius: 18px;
    border: 1px solid rgba(191, 9, 4, 0.3);
}

.code-rain::before {
    content: "01 10 11 00 10 11 01 10 00 11 10 01 11 00 10 11 01";
    position: absolute;
    inset: -40px;
    color: rgba(0, 255, 128, 0.2);
    font-family: "Courier New", monospace;
    animation: rain 5s linear infinite;
    white-space: pre-wrap;
}

@keyframes rain {
    from {
        transform: translateY(-40%);
    }

    to {
        transform: translateY(40%);
    }
}

/* Timeline */
.timeline {
    display: flex;
    justify-content: space-between;
    gap: 10px;
    margin: 4px 0 22px;
}

/* Stage states */
.stage {
    cursor: default;
}

/* Completed stages can be clicked */
.stage.completed {
    cursor: pointer;
    border-color: rgba(0, 255, 128, 0.4);
}

.stage.completed:hover {
    box-shadow: 0 0 14px rgba(0, 255, 128, 0.25);
    transform: translateY(-1px);
}

.stage {
    flex: 1;
    padding: 10px 12px;
    background: rgba(6, 6, 6, 0.9);
    border-radius: 999px;
    border: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.82rem;
    color: var(--muted);
    transition: var(--transition);
}

.stage-number {
    width: 22px;
    height: 22px;
    border-radius: 999px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0.72rem;
    background: #151515;
    border: 1px solid var(--border);
}

.stage.active {
    background: linear-gradient(90deg, #190000, #2a0202);
    border-color: var(--accent-soft);
    color: #fff;
    box-shadow: 0 0 12px rgba(191, 9, 4, 0.55);
}

.stage.active .stage-number {
    background: var(--accent);
    border-color: var(--accent-soft);
}

/* Panels */
.panel {
    background: linear-gradient(135deg, var(--bg-panel), #050505);
    border-radius: var(--radius);
    padding: 18px 18px 20px;
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
    margin-bottom: 18px;
}

.panel h2 {
    margin: 0 0 8px;
    font-size: 1.2rem;
    letter-spacing: 0.16em;
    text-transform: uppercase;
}

.panel-intro {
    margin: 0 0 16px;
    color: var(--muted);
    font-size: 0.9rem;
}

.hidden {
    display: none;
}

/* Buttons */
.btn {
    border-radius: 999px;
    padding: 8px 18px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(32, 32, 32, 0.95);
    color: var(--text);
    cursor: pointer;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    transition: var(--transition);
}

.btn.primary {
    background: linear-gradient(90deg, var(--accent), var(--accent-soft));
    border-color: rgba(255, 255, 255, 0.25);
    box-shadow: 0 0 18px rgba(191, 9, 4, 0.7);
}

.btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.06);
}

/* Inputs */
.input-row {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 12px;
}

input[type="number"],
input[type="text"],
input:not([type]) {
    flex: 1;
    min-width: 160px;
    padding: 8px 11px;
    border-radius: 999px;
    border: 1px solid #2c2c2c;
    background: #050505;
    color: var(--text);
    font-size: 0.9rem;
    outline: none;
    transition: var(--transition);
}

input:focus {
    border-color: var(--accent-soft);
    box-shadow: 0 0 10px rgba(191, 9, 4, 0.4);
}

/* Riddle card */
.riddle-card {
    background: linear-gradient(135deg, #111, #191919);
    border-radius: var(--radius);
    padding: 14px 14px 16px;
    border: 1px solid rgba(255, 255, 255, 0.04);
}

.riddle-text {
    margin: 0 0 10px;
    line-height: 1.5;
}

.highlight-word {
    color: var(--accent-soft);
    font-weight: 600;
}

.riddle-hint {
    margin: 0;
    font-size: 0.82rem;
    color: var(--muted);
}

.feedback {
    margin-top: 10px;
    font-size: 0.87rem;
}

.feedback.error {
    color: var(--error);
}

.feedback.success {
    color: var(--success);
}

/* Chat window */
.chat-window {
    max-height: 260px;
    overflow-y: auto;
    padding-right: 4px;
    margin-bottom: 10px;
}

.chat-message {
    padding: 8px 10px;
    margin-bottom: 6px;
    border-radius: 10px;
    font-size: 0.86rem;
    line-height: 1.4;
    border: 1px solid rgba(255, 255, 255, 0.04);
}

.chat-name {
    display: block;
    font-weight: 600;
    margin-bottom: 2px;
    font-size: 0.78rem;
    text-transform: uppercase;
    letter-spacing: 0.12em;
}

.chat-text {
    color: var(--muted);
}

.chat-message.tokyo {
    background: linear-gradient(135deg, #190000, #3b0202);
}

.chat-message.professor {
    background: linear-gradient(135deg, #04080f, #050505);
}

.chat-message.berlin {
    background: linear-gradient(135deg, #141414, #1c0f0f);
}

.chat-message.nairobi {
    background: linear-gradient(135deg, #06120f, #050505);
}

.chat-message.rio {
    background: linear-gradient(135deg, #11051b, #050505);
}

.chat-emphasis {
    color: var(--accent-soft);
    font-weight: 600;
}

.small-hint {
    font-size: 0.8rem;
    color: var(--muted);
    font-style: italic;
    margin-top: 2px;
}

/* Terminal */
.terminal {
    background: #050505;
    border-radius: 10px;
    border: 1px solid #222;
    font-family: "Fira Code", "Consolas", monospace;
    overflow: hidden;
}

.terminal-header {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 5px 10px;
    background: linear-gradient(to right, #0a0a0a, #151515);
    border-bottom: 1px solid #222;
    font-size: 0.75rem;
    color: var(--muted);
}

.dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
}

.dot.red {
    background: #ff5f56;
}

.dot.yellow {
    background: #ffbd2e;
}

.dot.green {
    background: #27c93f;
}

.terminal-body {
    max-height: 200px;
    overflow-y: auto;
    padding: 8px 10px;
    font-size: 0.86rem;
}

.term-line {
    color: var(--code);
    margin-bottom: 2px;
}

.terminal-input-row {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px 8px;
    border-top: 1px solid #222;
    background: #050505;
}

.prompt {
    color: #c5c8c6;
    font-size: 0.85rem;
}

#terminal-input {
    flex: 1;
    border-radius: 4px;
    padding: 4px 6px;
    background: transparent;
    border: none;
    outline: none;
    color: #fefefe;
    font-family: inherit;
    font-size: 0.86rem;
}

.final-message {
    margin-top: 12px;
    font-size: 0.9rem;
    color: var(--accent-soft);
}

/* Footer */
.footer {
    margin-top: 18px;
    text-align: center;
    font-size: 0.78rem;
    color: var(--muted);
    opacity: 0.8;
}

/* Responsive */
@media (max-width: 800px) {
    .hero {
        grid-template-columns: 1fr;
    }

    .hero-art {
        order: -1;
        margin-bottom: 6px;
    }
}

@media (max-width: 600px) {
    .top-bar {
        padding-inline: 16px;
    }

    .container {
        padding-inline: 12px;
    }

    .panel {
        padding-inline: 12px;
    }

    .timeline {
        flex-direction: column;
    }
}

.music-bar {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 8px;
    margin-bottom: 10px;
}

.btn.small {
    padding: 6px 14px;
    font-size: 0.78rem;
    letter-spacing: 0.08em;
}